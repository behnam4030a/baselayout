/**
 * Textarea Component Styles
 * کامپوننت ناحیه متنی - استایل‌ها
 *
 * این فایل شامل تمام استایل‌های کامپوننت Textarea است
 * مطابق با Design Tokens استخراج شده از Figma
 *
 * ساختار HTML:
 * <div class="textarea textarea--large">
 *   <div class="textarea__container">
 *     <textarea class="textarea__field" placeholder="متن نگهدارنده"></textarea>
 *   </div>
 * </div>
 *
 * ارتفاع کل = wrapper border (2px) + container border (2px) + field height
 * field height (box-sizing: border-box) شامل padding خودش است
 */

/* ==========================================
   CSS Custom Properties از Design Tokens
   ========================================== */

:root {
  /* Neutral Foreground */
  --textarea-color-neutral-fg-placeholder: var(--neutral-360);
  --textarea-color-neutral-fg-text: var(--neutral-880);
  --textarea-color-neutral-fg-disabled: var(--neutral-260);

  /* Neutral Background */
  --textarea-color-neutral-bg-rest: var(--neutral-0);
  --textarea-color-neutral-bg-readonly: var(--neutral-20);

  /* Neutral Stroke */
  --textarea-color-neutral-stroke-rest: var(--neutral-100);
  --textarea-color-neutral-stroke-hover: var(--neutral-140);
  --textarea-color-neutral-stroke-disabled: var(--neutral-120);

  /* Accessible Indicator Colors */
  --textarea-color-accessible-rest: var(--neutral-620);
  --textarea-color-accessible-hover: var(--neutral-660);
  --textarea-color-accessible-selected: var(--brand-300);

  /* Danger (Error) */
  --textarea-color-danger-bg: var(--cranberry-25);
  --textarea-color-danger-stroke: var(--cranberry-500);

  /* Radius */
  --textarea-radius: 8px;

  /* Shadows */
  --textarea-shadow-focused: 0px 2px 3px 1px rgba(42, 187, 156, 0.2);

  /* Spacing */
  --textarea-padding-x-lg: 16px;
  --textarea-padding-x-md: 12px;
  --textarea-padding-x-sm: 8px;
  --textarea-padding-y: 8px;
  --textarea-gap: 8px;

  /* Size — ارتفاع کل کامپوننت شامل همه borderها */
  --textarea-height-lg: 72px;
  --textarea-height-md: 64px;
  --textarea-height-sm: 36px;
  --textarea-width: 320px;

  /* Resize Handler */
  --textarea-resize-handler: 12px;

  /* Indicator */
  --textarea-indicator-height: 1.5px;

  /* Transition */
  --textarea-transition: 0.15s ease;
}

/* ==========================================
   Base Component (ساختار پایه)
   ========================================== */

.textarea {
  /* Internal state variables — overridden by state rules */
  --_text-color: var(--textarea-color-neutral-fg-text);
  --_placeholder-color: var(--textarea-color-neutral-fg-placeholder);
  --_border-color: var(--textarea-color-neutral-stroke-rest);
  --_bg-color: var(--textarea-color-neutral-bg-rest);
  --_shadow: none;
  --_outer-border-color: transparent;
  --_indicator-shadow: inset 0 calc(-1 * var(--textarea-indicator-height)) 0 0 transparent;
  --_cursor: text;
  --_resize: none;

  position: relative;
  width: var(--textarea-width);
  border-radius: var(--textarea-radius);
  box-sizing: border-box;
  font-family: var(--typo-font-family);
  border: 1px solid var(--_outer-border-color);
}

/* ==========================================
   Inner Container (کانتینر داخلی)
   بدون padding — padding روی field است
   ========================================== */

.textarea__container {
  border-radius: var(--textarea-radius);
  border: 1px solid var(--_border-color);
  background-color: var(--_bg-color);
  box-shadow: var(--_shadow), var(--_indicator-shadow);
  box-sizing: border-box;
  cursor: var(--_cursor);
  transition:
    border-color var(--textarea-transition),
    background-color var(--textarea-transition),
    box-shadow var(--textarea-transition);
}

/* ==========================================
   Native Textarea Field (فیلد ورودی)
   padding اینجاست — با box-sizing: border-box
   شامل ارتفاع خودش می‌شود
   ========================================== */

.textarea__field {
  display: block;
  width: 100%;
  border: none;
  outline: none;
  background: transparent;
  font-family: var(--typo-font-family);
  font-weight: var(--typo-body-medium-200-weight);
  letter-spacing: 0;
  color: var(--_text-color);
  cursor: var(--_cursor);
  box-sizing: border-box;
  margin: 0;
  resize: var(--_resize);
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
  text-align: right;
  transition: color var(--textarea-transition);
}

.textarea__field::placeholder {
  color: var(--_placeholder-color);
  opacity: 1;
  transition: color var(--textarea-transition);
}

/* ==========================================
   Size: Large (سایز بزرگ)
   ارتفاع کل: 72px = 2px (wrapper border) + 2px (container border) + 68px (field)
   ========================================== */

.textarea--large .textarea__field {
  height: calc(var(--textarea-height-lg) - 4px);
  padding: var(--textarea-padding-y) var(--textarea-padding-x-lg);
  font-size: var(--typo-body-medium-200-size);
  line-height: var(--typo-body-medium-200-line-height);
}

/* ==========================================
   Size: Medium (سایز متوسط)
   ارتفاع کل: 64px = 2px + 2px + 60px (field)
   ========================================== */

.textarea--medium .textarea__field {
  height: calc(var(--textarea-height-md) - 4px);
  padding: var(--textarea-padding-y) var(--textarea-padding-x-md);
  font-size: var(--typo-body-medium-200-size);
  line-height: var(--typo-body-medium-200-line-height);
}

/* ==========================================
   Size: Small (سایز کوچک)
   ارتفاع کل: 36px = 2px + 2px + 32px (field)
   ========================================== */

.textarea--small .textarea__field {
  height: calc(var(--textarea-height-sm) - 4px);
  padding: var(--textarea-padding-y) var(--textarea-padding-x-sm);
  font-size: var(--typo-body-small-150-size);
  line-height: var(--typo-body-small-150-line-height);
}

/* ==========================================
   Resize Handler (قابلیت تغییر اندازه)
   resize: vertical با height صریح — مرورگر
   خودش اجازه بزرگتر شدن از height اولیه را می‌دهد
   ========================================== */

.textarea--resizable {
  --_resize: vertical;
}

/* ==========================================
   State: Hover (هاور)
   ========================================== */

.textarea:hover:not(:has(.textarea__field:disabled)):not(:has(.textarea__field[readonly])):not(.textarea--error) {
  --_border-color: var(--textarea-color-neutral-stroke-hover);
  --_indicator-shadow: inset 0 calc(-1 * var(--textarea-indicator-height)) 0 0 var(--textarea-color-accessible-hover);
}

/* Hover fallback — مرورگرهای بدون :has() */
@supports not selector(:has(*)) {
  .textarea:hover:not(.textarea--disabled):not(.textarea--readonly):not(.textarea--error) {
    --_border-color: var(--textarea-color-neutral-stroke-hover);
    --_indicator-shadow: inset 0 calc(-1 * var(--textarea-indicator-height)) 0 0 var(--textarea-color-accessible-hover);
  }
}

/* ==========================================
   State: Focused (فوکوس)
   ========================================== */

.textarea:focus-within:not(:has(.textarea__field:disabled)):not(.textarea--error) {
  --_shadow: var(--textarea-shadow-focused);
  --_indicator-shadow: inset 0 calc(-1 * var(--textarea-indicator-height)) 0 0 var(--textarea-color-accessible-selected);
  --_cursor: text;
}

/* Focused fallback */
@supports not selector(:has(*)) {
  .textarea:focus-within:not(.textarea--disabled):not(.textarea--error) {
    --_shadow: var(--textarea-shadow-focused);
    --_indicator-shadow: inset 0 calc(-1 * var(--textarea-indicator-height)) 0 0 var(--textarea-color-accessible-selected);
    --_cursor: text;
  }
}

/* ==========================================
   State: Error (خطا)
   ========================================== */

.textarea.textarea--error {
  --_outer-border-color: var(--textarea-color-danger-stroke);
  --_bg-color: var(--textarea-color-danger-bg);
  --_indicator-shadow: inset 0 calc(-1 * var(--textarea-indicator-height)) 0 0 transparent;
}

/* ==========================================
   State: Disabled (غیرفعال)
   ========================================== */

.textarea:has(.textarea__field:disabled) {
  --_text-color: var(--textarea-color-neutral-fg-disabled);
  --_placeholder-color: var(--textarea-color-neutral-fg-disabled);
  --_border-color: var(--textarea-color-neutral-stroke-disabled);
  --_bg-color: transparent;
  --_shadow: none;
  --_outer-border-color: transparent;
  --_indicator-shadow: inset 0 calc(-1 * var(--textarea-indicator-height)) 0 0 transparent;
  --_cursor: not-allowed;
  --_resize: none;
}

/* Disabled fallback */
.textarea.textarea--disabled {
  --_text-color: var(--textarea-color-neutral-fg-disabled);
  --_placeholder-color: var(--textarea-color-neutral-fg-disabled);
  --_border-color: var(--textarea-color-neutral-stroke-disabled);
  --_bg-color: transparent;
  --_shadow: none;
  --_outer-border-color: transparent;
  --_indicator-shadow: inset 0 calc(-1 * var(--textarea-indicator-height)) 0 0 transparent;
  --_cursor: not-allowed;
  --_resize: none;
}

/* جلوگیری از hover/focus در حالت disabled */
.textarea:has(.textarea__field:disabled):hover,
.textarea.textarea--disabled:hover {
  --_border-color: var(--textarea-color-neutral-stroke-disabled);
  --_indicator-shadow: inset 0 calc(-1 * var(--textarea-indicator-height)) 0 0 transparent;
  --_cursor: not-allowed;
}

.textarea:has(.textarea__field:disabled):focus-within,
.textarea.textarea--disabled:focus-within {
  --_border-color: var(--textarea-color-neutral-stroke-disabled);
  --_shadow: none;
  --_indicator-shadow: inset 0 calc(-1 * var(--textarea-indicator-height)) 0 0 transparent;
}

/* ==========================================
   State: ReadOnly (فقط‌خواندنی)
   ========================================== */

.textarea:has(.textarea__field[readonly]) {
  --_border-color: transparent;
  --_bg-color: var(--textarea-color-neutral-bg-readonly);
  --_shadow: none;
  --_outer-border-color: transparent;
  --_indicator-shadow: inset 0 calc(-1 * var(--textarea-indicator-height)) 0 0 transparent;
}

/* ReadOnly fallback */
.textarea.textarea--readonly {
  --_border-color: transparent;
  --_bg-color: var(--textarea-color-neutral-bg-readonly);
  --_shadow: none;
  --_outer-border-color: transparent;
  --_indicator-shadow: inset 0 calc(-1 * var(--textarea-indicator-height)) 0 0 transparent;
}

/* جلوگیری از hover indicator در readonly */
.textarea:has(.textarea__field[readonly]):hover,
.textarea.textarea--readonly:hover {
  --_border-color: transparent;
  --_indicator-shadow: inset 0 calc(-1 * var(--textarea-indicator-height)) 0 0 transparent;
  --_cursor: text;
}

/* ==========================================
   RTL / LTR Support (پشتیبانی راست‌به‌چپ)
   ========================================== */

[dir="ltr"] .textarea__field,
.textarea[dir="ltr"] .textarea__field {
  text-align: left;
}

/* ==========================================
   Full Width Utility
   ========================================== */

.textarea--full-width {
  width: 100%;
}

/* ==========================================
   Counter (شمارنده کاراکتر)
   ========================================== */

.textarea__counter {
  display: block;
  font-family: var(--typo-font-family);
  font-size: 12px;
  line-height: 2;
  color: var(--neutral-660);
  margin-top: 6px;
  text-align: end;
}

/* Counter — Disabled */
.textarea:has(.textarea__field:disabled) .textarea__counter,
.textarea.textarea--disabled .textarea__counter {
  color: var(--neutral-260);
}
